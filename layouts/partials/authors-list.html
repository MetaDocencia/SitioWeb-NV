{{/* authors-list.html
     Renderiza nombres completos y links a perfiles de autores.
     Uso: {{ partial "authors-list.html" (dict "Page" . "Authors" .Params.authors) }}
*/}}

{{- $p := .Page -}}
{{- $authors := .Authors | default (slice) -}}

{{- if gt (len $authors) 0 -}}
  {{- /* Mapa de aliases problemáticos -> Nombre completo esperado */ -}}
  {{- $nameMap := dict
      "abellini" "Alejandra Bellini"
      "andreasancheztapia" "Andrea Sanchez Tapia"
      "beatrizmilz" "Beatriz Milz"
      "claudianoneto" "Claudiano Neto"
      "elianagonzalez" "Eliana Gonzalez"
      "eliocampitelli" "Elio Campitelli"
      "ernestomirt" "Ernesto Mirt"
      "okus" "Mariela Rajngewerc"
      "maxwelloliveira" "Maxwell Oliveira"
      "monicaalonso" "Mónica Alonso"
      "mgayol" "Maira Gayol"
  -}}

  <span>·</span>
  <span>
    {{- $last := sub (len $authors) 1 -}}
    {{- range $i, $auth := $authors -}}
      {{- $alias := lower (urlize $auth) -}}

      {{/* 1) Intento directo por slug /authors/<alias> */}}
      {{- $apage := site.GetPage (printf "/authors/%s" $alias) -}}

      {{/* 2) Si no existe, intento buscar por Título esperado a partir del mapa */}}
      {{- if not $apage -}}
        {{- $expectedName := index $nameMap $alias -}}
        {{- if $expectedName -}}
          {{- with site.GetPage "/authors" -}}
            {{- $found := false -}}
            {{- range .Pages -}}
              {{- if eq .Title $expectedName -}}
                {{- $apage = . -}}
                {{- $found = true -}}
                {{- break -}}
              {{- end -}}
            {{- end -}}
          {{- end -}}
        {{- end -}}
      {{- end -}}

      {{/* 3) Render: con link si hay página; si no, nombre esperado o alias */}}
      {{- if $apage -}}
        <a href="{{ $apage.RelPermalink }}" class="hover:underline">{{ $apage.Title }}</a>
      {{- else -}}
        {{- with (index $nameMap $alias) -}}
          {{ . }}
        {{- else -}}
          {{ $auth }}
        {{- end -}}
      {{- end -}}

      {{- if lt $i $last }}, {{ end -}}
    {{- end -}}
  </span>
{{- end -}}
