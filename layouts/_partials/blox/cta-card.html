{{/* layouts/_partials/blox/cta-card.html
     CTA full-width (bleed) que respeta content.title, content.text, content.button
     y design.card.css_class / design.card.css_style. */}}

{{- $b := .block | default dict -}}
{{- if not (isset . "block") -}}
  {{- /* Si se llamara mal, evitamos romper el build. */ -}}
  {{- /* Debug: */ -}}<!-- mdnv: cta-card override recibiÃ³ contexto sin ".block" -->
  {{- return -}}
{{- end -}}

{{- $content := (index $b "content") | default dict -}}
{{- $design  := (index $b "design")  | default dict -}}
{{- $card    := (index $design "card") | default dict -}}

{{- $id     := or (index $b "id") (anchorize (index $content "title")) | default "cta-card" -}}
{{- $title  := (index $content "title") | default "" -}}
{{- $text   := (index $content "text")  | default "" -}}

{{- $btn        := (index $content "button") | default dict -}}
{{- $btn_text   := (index $btn "text")   | default "" -}}
{{- $btn_url    := (index $btn "url")    | default "" -}}
{{- $btn_target := (index $btn "target") | default "" -}}

{{- $css_class := (index $card "css_class") | default "" -}}
{{- $css_style := (index $card "css_style") | default "" -}}

<!-- mdnv: cta-card override activo -->
<section id="{{ $id }}" class="mdnv-cta my-6">
  <!-- Bleed: ocupa todo el ancho real de la ventana -->
  <div class="mdnv-cta-bleed">
    <!-- Contenido centrado con padding lateral fluido -->
    <div class="mdnv-cta-inner {{ $css_class }}" style="{{ $css_style }}">
      <div class="mdnv-cta-content">
        {{- if $title }}
          <h2 class="section-title">{{ $title }}</h2>
        {{- end }}
        {{- with $text }}
          <div class="prose max-w-none">{{ . | markdownify }}</div>
        {{- end }}

        {{- if and $btn_text $btn_url }}
          <div class="mt-4">
            <a href="{{ $btn_url }}"
               {{ if $btn_target }}target="{{ $btn_target }}" rel="noopener"{{ end }}
               class="inline-block no-underline font-semibold px-5 py-2 rounded-md">
              {{ $btn_text }}
            </a>
          </div>
        {{- end }}
      </div>
    </div>
  </div>
</section>

<style>
/* ===== Estilos locales del CTA (seguros para reusar) ===== */
.mdnv-cta-bleed{
  position:relative; left:50%; right:50%;
  margin-left:-50vw; margin-right:-50vw; width:100vw;
}
.mdnv-cta-inner{
  max-width:1600px; margin:0 auto;
  padding: clamp(1rem, 4vw, 3rem);
  border-radius: .75rem;
}
.mdnv-cta-content .section-title{
  margin: 0 0 .5rem 0;
}
</style>
